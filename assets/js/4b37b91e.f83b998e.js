"use strict";(self.webpackChunkcs_notes=self.webpackChunkcs_notes||[]).push([[5697],{47256:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>t,metadata:()=>l,toc:()=>o});var i=n(85893),a=n(11151);const t={slug:"/deep-learning/siamese-network",id:"siamese-network",title:"Siamese Network",description:"Siamese Network"},r=void 0,l={id:"deep-learning/siamese-network/siamese-network",title:"Siamese Network",description:"Siamese Network",source:"@site/docs/deep-learning/07-siamese-network/siamese-network.md",sourceDirName:"deep-learning/07-siamese-network",slug:"/deep-learning/siamese-network",permalink:"/cs-notes/deep-learning/siamese-network",draft:!1,unlisted:!1,editUrl:"https://github.com/glennhenry/cs-notes/tree/main/docs/deep-learning/07-siamese-network/siamese-network.md",tags:[],version:"current",lastUpdatedBy:"glennhenry",lastUpdatedAt:1706610644,formattedLastUpdatedAt:"Jan 30, 2024",frontMatter:{slug:"/deep-learning/siamese-network",id:"siamese-network",title:"Siamese Network",description:"Siamese Network"},sidebar:"sidebar",previous:{title:"U-Net",permalink:"/cs-notes/deep-learning/u-net"},next:{title:"RNN",permalink:"/cs-notes/deep-learning/rnn"}},c={},o=[{value:"Basic Idea",id:"basic-idea",level:3},{value:"Architecture",id:"architecture",level:3},{value:"Embedding Layer",id:"embedding-layer",level:4},{value:"Calculating Distance",id:"calculating-distance",level:4},{value:"Triplet-based Siamese Network",id:"triplet-based-siamese-network",level:3},{value:"Triplet Loss",id:"triplet-loss",level:4},{value:"Triplet Mining",id:"triplet-mining",level:4}];function h(e){const s={a:"a",annotation:"annotation",br:"br",h3:"h3",h4:"h4",img:"img",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mtext:"mtext",p:"p",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Main Source :"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.a,{href:"https://youtu.be/6jfw8MuKwpI?si=5bIxLyoAe8QQ_bBS",children:"C4W4L03 Siamese Network - DeepLearningAI"})})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.a,{href:"https://towardsdatascience.com/illustrated-guide-to-siamese-network-3939da1b0c9d",children:"Illustrated Guide to Siamese Network by Pranjal Gupta - Medium"})})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.a,{href:"https://www.v7labs.com/blog/triplet-loss",children:"Triplet Loss: Intro, Implementation, Use Cases"})})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:(0,i.jsx)(s.a,{href:"https://towardsdatascience.com/siamese-networks-introduction-and-implementation-2140e3443dee",children:"Siamese Networks Introduction and Implementation by Aditya Dutt - Medium"})})}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Siamese Network"})," is a type of ",(0,i.jsx)(s.a,{href:"/deep-learning/neural-network",children:"neural network"})," architecture designed to compare and measure similarity between pair of input data, one of the use case is to verify signature like fingerprint."]}),"\n",(0,i.jsx)(s.h3,{id:"basic-idea",children:"Basic Idea"}),"\n",(0,i.jsxs)(s.p,{children:["The basic idea of how siamese network works is there will be two identical network, called ",(0,i.jsx)(s.strong,{children:"twins"})," or ",(0,i.jsx)(s.strong,{children:"branches"})," which has the shared weights and architecture. The input data will go into both twins, the network will process it and give the input some score based on its features. If the score are close, it means they are similar, and vice versa."]}),"\n",(0,i.jsx)(s.p,{children:"The pair of input will be provided along with the label (whether they are similar or not), the network will adjust its parameters to make sure similar input will also have similar score."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.img,{alt:"Siamese network illustration",src:n(66417).Z+"",width:"685",height:"325"}),(0,i.jsx)(s.br,{}),"\n","Source : ",(0,i.jsx)(s.a,{href:"https://pyimagesearch.com/2020/11/30/siamese-networks-with-keras-tensorflow-and-deep-learning/",children:"https://pyimagesearch.com/2020/11/30/siamese-networks-with-keras-tensorflow-and-deep-learning/"})]}),"\n",(0,i.jsx)(s.h3,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsxs)(s.p,{children:["Siamese networks share the same architecture, if the task is to recognize similar image, then they will have the identical ",(0,i.jsx)(s.a,{href:"/deep-learning/cnn",children:"convolutional networks"}),". The convolution network will flatten its data at the last layer before it goes into the fully-connected layer, same as the original CNN. However, the classifier in the fully-connected layer will not be included. It will go into the next layer called ",(0,i.jsx)(s.strong,{children:"embedding layer"}),"."]}),"\n",(0,i.jsx)(s.h4,{id:"embedding-layer",children:"Embedding Layer"}),"\n",(0,i.jsx)(s.p,{children:"This is where we give each input its corresponding score, it works by mapping the input data with many features into a lower-dimensional space so that the similarity can be easily measured."}),"\n",(0,i.jsxs)(s.p,{children:["The input which comes from the previous layer will be represented in vectors. They will be transformed into vector by applying a normalization operation, which is an operation to transform data into some scale. The normalization is called ",(0,i.jsx)(s.strong,{children:"L2 normalization"})," or ",(0,i.jsx)(s.strong,{children:"Euclidean normalization"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:["This process is also called ",(0,i.jsx)(s.strong,{children:"image encoding"}),", where we transform input into a compact representation or embedding that captures its charateristics. The embedding process is similar to the embedding in ",(0,i.jsx)(s.a,{href:"/deep-learning/deep-learning-tasks#natural-language-processing-nlp",children:"NLP"}),"."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.img,{alt:"Siamese layers",src:n(3757).Z+"",width:"150",height:"708"}),(0,i.jsx)(s.br,{}),"\n","Source : ",(0,i.jsx)(s.a,{href:"https://towardsdatascience.com/illustrated-guide-to-siamese-network-3939da1b0c9d",children:"https://towardsdatascience.com/illustrated-guide-to-siamese-network-3939da1b0c9d"})]}),"\n",(0,i.jsx)(s.h4,{id:"calculating-distance",children:"Calculating Distance"}),"\n",(0,i.jsxs)(s.p,{children:["After they are represented in a lower-dimensional space, the inputs are compared in the space using technique like ",(0,i.jsx)(s.strong,{children:"Euclidean distance"})," or ",(0,i.jsx)(s.strong,{children:"cosine similarity"}),". The result distance is the measure of how similar are the input, the model will predict by categorizing the input as similar or not similar based on some threshold."]}),"\n",(0,i.jsx)(s.p,{children:"After the prediction is done, the learning process will be the same as traditional network which includes loss calculation, backpropagation, and parameters update. The goal is to make our embedding better, we should map similar samples to have small distances between their embeddings and dissimilar samples to have large distances."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.img,{alt:"Embedding distance",src:n(59494).Z+"",width:"329",height:"280"}),(0,i.jsx)(s.br,{}),"\n","Source : ",(0,i.jsx)(s.a,{href:"https://www.researchgate.net/figure/Improving-the-similarity-distance-in-an-embedding-space_fig1_346902941",children:"https://www.researchgate.net/figure/Improving-the-similarity-distance-in-an-embedding-space_fig1_346902941"})]}),"\n",(0,i.jsx)(s.h3,{id:"triplet-based-siamese-network",children:"Triplet-based Siamese Network"}),"\n",(0,i.jsxs)(s.p,{children:["There is a variant of siamese network called ",(0,i.jsx)(s.strong,{children:"triplet-based Siamese network"}),", which uses 3 types of sample in the training process."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Anchor"})," : Specific sample that serves as the reference point for comparison."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Positive"})," : Positive sample is the input which is a similar to the anchor."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Negative"})," : Negative sample is the input which is not similar to the anchor."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Compared to standard siamese network, the triplet-based approach provides a more fine-grained learning signal. It enables the network to learn to rank or order examples based on their similarity to the anchor, rather than just predicting similar or not. By using the anchor as a reference, the network can learn to focus on the specific characteristics that distinguish positive examples from negative examples."}),"\n",(0,i.jsx)(s.p,{children:"In this context, a good embedding mean that we successfully map the positive sample and the anchor sample close while the negative is distinguished from these two."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.img,{alt:"Embedding result",src:n(97150).Z+"",width:"499",height:"189"}),(0,i.jsx)(s.br,{}),"\n","Source : ",(0,i.jsx)(s.a,{href:"https://www.v7labs.com/blog/triplet-loss",children:"https://www.v7labs.com/blog/triplet-loss"})]}),"\n",(0,i.jsx)(s.h4,{id:"triplet-loss",children:"Triplet Loss"}),"\n",(0,i.jsxs)(s.p,{children:["The loss function used for triplet-based siamese network is called the ",(0,i.jsx)(s.strong,{children:"triplet loss"}),". It involve calculating the distance of positive and negative sample with the anchor point. Triplet loss measure how correct our embedding is, we will aim to minimize the loss. We will minimize the distance between positive and anchor while maximizing the distance between negative and the anchor."]}),"\n",(0,i.jsx)(s.p,{children:"The formula for triplet loss is :"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"L"}),(0,i.jsx)(s.mo,{children:"="}),(0,i.jsx)(s.mtext,{children:"max"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"d"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"A"}),(0,i.jsx)(s.mo,{separator:"true",children:","}),(0,i.jsx)(s.mi,{children:"P"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{children:"\u2212"}),(0,i.jsx)(s.mi,{children:"d"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"A"}),(0,i.jsx)(s.mo,{separator:"true",children:","}),(0,i.jsx)(s.mi,{children:"N"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"}),(0,i.jsx)(s.mo,{children:"+"}),(0,i.jsx)(s.mtext,{children:"margin"}),(0,i.jsx)(s.mo,{separator:"true",children:","}),(0,i.jsx)(s.mn,{children:"0"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"L = \\text{max}(d(A, P) - d(A, N) + \\text{margin}, 0)"})]})})}),(0,i.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"L"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(s.span,{className:"mrel",children:"="}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"max"})}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,i.jsx)(s.span,{className:"mpunct",children:","}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(s.span,{className:"mclose",children:")"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,i.jsx)(s.span,{className:"mpunct",children:","}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),(0,i.jsx)(s.span,{className:"mclose",children:")"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(s.span,{className:"mbin",children:"+"}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord text",children:(0,i.jsx)(s.span,{className:"mord",children:"margin"})}),(0,i.jsx)(s.span,{className:"mpunct",children:","}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(s.span,{className:"mord",children:"0"}),(0,i.jsx)(s.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,i.jsx)(s.p,{children:"Where :"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"d"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"A"}),(0,i.jsx)(s.mo,{separator:"true",children:","}),(0,i.jsx)(s.mi,{children:"P"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"d(A, P)"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,i.jsx)(s.span,{className:"mpunct",children:","}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"P"}),(0,i.jsx)(s.span,{className:"mclose",children:")"})]})})]})," : Distance between anchor and positive example in the embedding space.",(0,i.jsx)(s.br,{}),"\n",(0,i.jsxs)(s.span,{className:"katex",children:[(0,i.jsx)(s.span,{className:"katex-mathml",children:(0,i.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(s.semantics,{children:[(0,i.jsxs)(s.mrow,{children:[(0,i.jsx)(s.mi,{children:"d"}),(0,i.jsx)(s.mo,{stretchy:"false",children:"("}),(0,i.jsx)(s.mi,{children:"A"}),(0,i.jsx)(s.mo,{separator:"true",children:","}),(0,i.jsx)(s.mi,{children:"N"}),(0,i.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(s.annotation,{encoding:"application/x-tex",children:"d(A, N)"})]})})}),(0,i.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(s.span,{className:"base",children:[(0,i.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(s.span,{className:"mopen",children:"("}),(0,i.jsx)(s.span,{className:"mord mathnormal",children:"A"}),(0,i.jsx)(s.span,{className:"mpunct",children:","}),(0,i.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),(0,i.jsx)(s.span,{className:"mclose",children:")"})]})})]})," : Distance between anchor and negative example in the embedding space.",(0,i.jsx)(s.br,{}),"\n","margin : Hyperparameter that defines the minimum desired difference between the distances of the anchor-positive pair and the anchor-negative pair."]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.img,{alt:"Anchor, positive, and negative embedding before and after learning",src:n(44845).Z+"",width:"850",height:"204"}),(0,i.jsx)(s.br,{}),"\n","Source : ",(0,i.jsx)(s.a,{href:"https://www.researchgate.net/figure/Distances-among-anchor-positive-and-negative-samples-during-training-using-Siamese_fig2_358019630",children:"https://www.researchgate.net/figure/Distances-among-anchor-positive-and-negative-samples-during-training-using-Siamese_fig2_358019630"})]}),"\n",(0,i.jsx)(s.h4,{id:"triplet-mining",children:"Triplet Mining"}),"\n",(0,i.jsx)(s.p,{children:"Triplet mining is the strategy used in triplet-based networks to select which dataset should we choose as the anchor, positive, or negative sample. The goal is to find the dataset that contribute the most to the learning process."}),"\n",(0,i.jsx)(s.p,{children:"It can be categorized into two based on when the triplet is generated :"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Online Mining"})," : Dynamically generates triplets sample during training process, we can adapt the samples to suit the model performance."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Offline Mining"})," : Pre-selected before the training process, it will be more efficient."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Three category based on how hard is the train triplet :"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Hard Triplet Mining"})," : Negative sample is closer to anchor than the positive."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Semi-Hard Triplet Mining"})," : Negative is close to the anchor, but not a zero distance."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Easy Triplet Mining"})," : Positive sample is close to anchor while negative is far."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Random Triplet Mining"})," : Randomly selected without considering their distance."]}),"\n"]})]})}function d(e={}){const{wrapper:s}={...(0,a.a)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},44845:(e,s,n)=>{n.d(s,{Z:()=>i});const i=n.p+"assets/images/anchor-positive-negative-7b3a5b648a5b95571c956092f68286f4.png"},59494:(e,s,n)=>{n.d(s,{Z:()=>i});const i=n.p+"assets/images/embedding-distance-b3d82624e3c27c968d439cf68ee3eae9.png"},97150:(e,s,n)=>{n.d(s,{Z:()=>i});const i=n.p+"assets/images/embedding-result-8ddabc123d02ad25c6e20e72cc9966ee.png"},3757:(e,s,n)=>{n.d(s,{Z:()=>i});const i=n.p+"assets/images/siamese-layers-5180b08d323b1b45f29eb5cd76e93c7c.png"},66417:(e,s,n)=>{n.d(s,{Z:()=>i});const i=n.p+"assets/images/siamese-network-5097a0b8f4320399e09bd63b1553fdbf.png"},11151:(e,s,n)=>{n.d(s,{Z:()=>l,a:()=>r});var i=n(67294);const a={},t=i.createContext(a);function r(e){const s=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(t.Provider,{value:s},e.children)}}}]);