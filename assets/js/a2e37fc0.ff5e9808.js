"use strict";(self.webpackChunkcs_notes=self.webpackChunkcs_notes||[]).push([[7428],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>f});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var p=a.createContext({}),l=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=l(e.components);return a.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(r),d=n,f=u["".concat(p,".").concat(d)]||u[d]||m[d]||o;return r?a.createElement(f,i(i({ref:t},c),{},{components:r})):a.createElement(f,i({ref:t},c))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[u]="string"==typeof e?e:n,i[1]=s;for(var l=2;l<o;l++)i[l]=r[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},36239:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=r(87462),n=(r(67294),r(3905));const o={slug:"/deep-learning/transformers/transformers-audio",id:"transformers-audio",title:"Transformers Audio",description:"Transformers Audio"},i=void 0,s={unversionedId:"deep-learning/transformers/transformers-audio/transformers-audio",id:"deep-learning/transformers/transformers-audio/transformers-audio",title:"Transformers Audio",description:"Transformers Audio",source:"@site/docs/deep-learning/13-transformers/07-transformers-audio/transformers.audio.md",sourceDirName:"deep-learning/13-transformers/07-transformers-audio",slug:"/deep-learning/transformers/transformers-audio",permalink:"/cs-notes/deep-learning/transformers/transformers-audio",draft:!1,editUrl:"https://github.com/glennhenry/cs-notes/tree/main/docs/deep-learning/13-transformers/07-transformers-audio/transformers.audio.md",tags:[],version:"current",lastUpdatedBy:"glennhenry",lastUpdatedAt:1696934937,formattedLastUpdatedAt:"Oct 10, 2023",frontMatter:{slug:"/deep-learning/transformers/transformers-audio",id:"transformers-audio",title:"Transformers Audio",description:"Transformers Audio"},sidebar:"sidebar",previous:{title:"Transformers Architecture",permalink:"/cs-notes/deep-learning/transformers/transformers-architecture"},next:{title:"BERT",permalink:"/cs-notes/deep-learning/transformers/bert"}},p={},l=[{value:"Spectogram",id:"spectogram",level:3},{value:"Input &amp; Output",id:"input--output",level:4},{value:"Seq2Seq",id:"seq2seq",level:3}],c={toc:l},u="wrapper";function m(e){let{components:t,...o}=e;return(0,n.kt)(u,(0,a.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Main Source :")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"https://huggingface.co/learn/audio-course/chapter3/introduction"},"Hugging Face Audio course part 3")))),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"/deep-learning/transformers/transformers-architecture"},"Transformers architecture")," can also be used for audio task, the application are speech recognition, music generation, audio classification, text-to-speech, and many more."),(0,n.kt)("p",null,"By audio task, it means transformers architecture will be modified to take input or produce output of text or audio. As long as the input can be turned into number, then we can use machine learning model for that task."),(0,n.kt)("p",null,"If the input is text then it will be easy, same as the original transformers architecture, it will be tokenized and turned into vector (embedding process). If the input is an audio data, one way to turn it into number is to transform it into ",(0,n.kt)("strong",{parentName:"p"},"spectogram"),"."),(0,n.kt)("h3",{id:"spectogram"},"Spectogram"),(0,n.kt)("p",null,"Spectogram is a visual representation of the frequency of a signal over time. The audio signal is divided into short segment, each segment will be transformed into frequency domain using technique like ",(0,n.kt)("a",{parentName:"p",href:"/digital-signal-processing/fourier-transform"},"fourier transform"),". Representing it in frequency domain helps us know which different frequency contribute to the overall signal, therefore it's a good way to capture information lies on the audio data for processing it in the transformers architecture."),(0,n.kt)("p",null,"Another variation of spectogram is the ",(0,n.kt)("strong",{parentName:"p"},"Mel-spectogram"),", it is a form of spectogram specifically made to focus on human perception of sound. Basically, we scale the audio signal so that lower frequency is more emphasized than higher frequency, this is because human perception is more sensitive to lower frequency range."),(0,n.kt)("p",null,"Another way to represent audio is using ",(0,n.kt)("strong",{parentName:"p"},"waveform"),", the representation shows how the amplitude of the signal varies over time. However, waveform tend to have longer length than spectogram, leading to more computation and memory usage."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Spectogram comparison",src:r(63367).Z,width:"614",height:"710"}),(0,n.kt)("br",{parentName:"p"}),"\n","Source : ",(0,n.kt)("a",{parentName:"p",href:"https://www.researchgate.net/figure/Waveform-spectrogram-and-mel-spectrogram-of-a-10-s-speech-segment-obtained-from-Google_fig1_333834541"},"https://www.researchgate.net/figure/Waveform-spectrogram-and-mel-spectrogram-of-a-10-s-speech-segment-obtained-from-Google_fig1_333834541")),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"Find more about ",(0,n.kt)("a",{parentName:"p",href:"/digital-signal-processing"},"signal processing")," or about ",(0,n.kt)("a",{parentName:"p",href:"/digital-media-processing/sound-audio-properties"},"audio"),".")),(0,n.kt)("h4",{id:"input--output"},"Input & Output"),(0,n.kt)("p",null,"To input waveform or spectogram into transformers encoder, they are typically divided into small segment first. The smaller segment will be fed into a ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("a",{parentName:"strong",href:"/deep-learning/cnn"},"convolutional neural network (CNN)")),", which act as the feature extractor. CNN can be a good feature extractor as it capable of capturing local patterns (e.g. frequency shape variation) from input data through the convolution operation."),(0,n.kt)("p",null,"If the output is a text, it will be similar to the original transformers architecture, we uses linear layer and softmax function on top of the decoder's output. To produce audio output, we will need some layer that produces audio sequence. The layer can be additional neural network such as linear layer or CNN. The layer can also refine the audio output for better quality."),(0,n.kt)("h3",{id:"seq2seq"},"Seq2Seq"),(0,n.kt)("p",null,"There are many variation of transformers architecture for audio processing. Some use encoder only to classify the audio or use decoder only to generate audio, other like Seq2Seq which is used in ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/openai/whisper"},"Whisper AI"),", uses both encoder and decoder to takes sequence and output another sequence."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Seq2Seq architecture",src:r(57656).Z,width:"665",height:"476"}),(0,n.kt)("br",{parentName:"p"}),"\n","Source : ",(0,n.kt)("a",{parentName:"p",href:"https://huggingface.co/learn/audio-course/chapter3/seq2seq"},"https://huggingface.co/learn/audio-course/chapter3/seq2seq")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Input")," : It takes log-mel spectogram which is the log scaled of mel spectogram as the input.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Spectogram Pre-processing (Conv1D + GELU)")," : The spectrogram is fed into a convolutional layer to extract features and patterns. It will use the GELU activation function, which is the variation of ReLU that has more smoother shape. The output of the CNN layers is then tokenized into smaller segments, similar to the tokenization step in the standard transformer models.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Positional Encoding")," : Positional encoding is added to the tokens to provide information about their relative positions in the sequence.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Encoder Block"),' : This includes the similar process to the standard transformers architecture, it includes attention layer that provide high-level summary and captures the "meaning" of the audio data.')),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Decoder Input")," : The decoder takes ",(0,n.kt)("strong",{parentName:"p"},"input from its own previously generated token"),". It will be positional encoded and will be passed into the next decoder's layer.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Cross-Attention")," : Cross-attention is when the encoder output is combined with the decoder previous result. The encoder, provides key and value vector while the decoder provides the query vector, similar to the original transformers architecture.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Decoder Output")," : The decoder outputs a token, the token can be converted back into text or converted into spectogram with further processing depending on the use case. The decoder will then use it for the next output step."))),(0,n.kt)("p",null,"Overall, the transformers architecture for audio is similar to the standard transformers, the difference falls in the input processing."))}m.isMDXComponent=!0},57656:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/seq2seq-architecture-05a17cd4e0982742917f0a018a727ad7.png"},63367:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/spectogram-c5ceae89a48574f6965a50b71c1e7062.png"}}]);