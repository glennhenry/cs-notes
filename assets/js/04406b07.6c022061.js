"use strict";(self.webpackChunkcs_notes=self.webpackChunkcs_notes||[]).push([[2867],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>h});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),c=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},m=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),p=c(r),u=n,h=p["".concat(l,".").concat(u)]||p[u]||d[u]||i;return r?a.createElement(h,o(o({ref:t},m),{},{components:r})):a.createElement(h,o({ref:t},m))}));function h(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:n,o[1]=s;for(var c=2;c<i;c++)o[c]=r[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}u.displayName="MDXCreateElement"},70854:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=r(87462),n=(r(67294),r(3905));const i={slug:"/machine-learning/collaborative-filtering",id:"collaborative-filtering",title:"Collaborative Filtering",description:"Collaborative Filtering"},o=void 0,s={unversionedId:"machine-learning/collaborative-filtering/collaborative-filtering",id:"machine-learning/collaborative-filtering/collaborative-filtering",title:"Collaborative Filtering",description:"Collaborative Filtering",source:"@site/docs/machine-learning/11-collaborative-filtering/collaborative-filtering.md",sourceDirName:"machine-learning/11-collaborative-filtering",slug:"/machine-learning/collaborative-filtering",permalink:"/cs-notes/machine-learning/collaborative-filtering",draft:!1,editUrl:"https://github.com/glennhenry/cs-notes/tree/main/docs/machine-learning/11-collaborative-filtering/collaborative-filtering.md",tags:[],version:"current",lastUpdatedBy:"glennhenry",lastUpdatedAt:1695899023,formattedLastUpdatedAt:"Sep 28, 2023",frontMatter:{slug:"/machine-learning/collaborative-filtering",id:"collaborative-filtering",title:"Collaborative Filtering",description:"Collaborative Filtering"},sidebar:"sidebar",previous:{title:"k-Means Clustering",permalink:"/cs-notes/machine-learning/k-means-clustering"},next:{title:"Deep Learning",permalink:"/cs-notes/deep-learning"}},l={},c=[{value:"How it works",id:"how-it-works",level:3},{value:"Item-based recommendation",id:"item-based-recommendation",level:4},{value:"User-based recommendation",id:"user-based-recommendation",level:4},{value:"Latent Factors",id:"latent-factors",level:4},{value:"Compression",id:"compression",level:4}],m={toc:c},p="wrapper";function d(e){let{components:t,...i}=e;return(0,n.kt)(p,(0,a.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Main Source :")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"https://youtu.be/p4ZZq0736Po?si=rLLlK6OGFDbP4piw"},"Deep learning lesson 7 - fastai"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},(0,n.kt)("a",{parentName:"strong",href:"https://youtu.be/n3RKsY2H-NE?si=hwrlSNwSirDgdQUp"},"How Recommender Systems Work (Netflix/Amazon) - Art of the Problem")))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Collaborative Filtering")," is a technique used for recommendation systems (e.g. youtube video feed) to provide personalized recommendation user based on their preferences. There are two types of collaborative filtering :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"User-based")," : In this approach, recommendations are based on similar user behaviors. For example, if user A watch several same movie as user B, and user A has watched a movie that user B hasn't watch before, the system might recommend that movie to user B.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("strong",{parentName:"p"},"Item-based")," : Also known as content-based, this approach focuses to recommend based on similarity between items. For example, if user A played a game with some specific genre before, the system might recommend another game which have similar or the same genre."),(0,n.kt)("p",{parentName:"li"},(0,n.kt)("img",{alt:"Type of collaborative filtering",src:r(57024).Z,width:"586",height:"371"}),(0,n.kt)("br",{parentName:"p"}),"\n","Source : ",(0,n.kt)("a",{parentName:"p",href:"https://medium.com/fnplus/neighbourhood-based-collaborative-filtering-4b7caedd2d11"},"https://medium.com/fnplus/neighbourhood-based-collaborative-filtering-4b7caedd2d11")))),(0,n.kt)("h3",{id:"how-it-works"},"How it works"),(0,n.kt)("p",null,"The first thing we do is to gather the user's data, suppose the recommendation system is to recommend specific movie. We can summarize all user rating to the corresponding movie with table like below."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"User rating table",src:r(15252).Z,width:"396",height:"243"}),(0,n.kt)("br",{parentName:"p"}),"\n","Source : ",(0,n.kt)("a",{parentName:"p",href:"https://youtu.be/n3RKsY2H-NE?si=13c6_Ug3sDtUDXxb&t=122"},"https://youtu.be/n3RKsY2H-NE?si=13c6_Ug3sDtUDXxb&t=122")),(0,n.kt)("p",null,"Some of the data will obviously be empty, indicating that the user hasn't rated or watched the movie yet. Suppose the system is going to recommend a movie to the user where the rating is empty, remember that the purpose of the recommendation system is to attract the user to watch the movie."),(0,n.kt)("p",null,"However, how can we know if a user will like a movie they haven't watched before? We will need an approximate measurement to indicate whether the user will like the movie or not. Thus, the problem becomes completing the data table."),(0,n.kt)("h4",{id:"item-based-recommendation"},"Item-based recommendation"),(0,n.kt)("p",null,"In item based recommendation, recommendation is based on item similarities, in this case, it might be a movie genre. So, the movie genre can be the variables or the features that determine if a user likes a movie or not."),(0,n.kt)("p",null,"User rating to specific genre will be gathered, and will be represented in matrix. The numbers will be calculated using dot product. We can also scale it down to suit with the appropriate rating ranges (e.g. minimum 0 and maximum 5)."),(0,n.kt)("p",null,"The idea of using the dot product is that if a user has a low rating for a particular genre, multiplying that rating with another number in another genre will result in an even lower value. Consequently, this lowers the overall rating. In other words, a low rating for a genre will decrease the rating for another movie with the same genre as well."),(0,n.kt)("p",null,"In the image below, user A likes comedy and dislikes action. Multiplying with the jurassic park movie, even though it has slight comedy, because the user rating toward action genre is 0, this makes the overall rating low."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Dot product between user and movie genre&#39;s rating",src:r(95519).Z,width:"405",height:"292"}),(0,n.kt)("br",{parentName:"p"}),"\n","Source : ",(0,n.kt)("a",{parentName:"p",href:"https://youtu.be/n3RKsY2H-NE?si=hxIzf4yWCppQHrc8&t=229"},"https://youtu.be/n3RKsY2H-NE?si=hxIzf4yWCppQHrc8&t=229")," (with modification)"),(0,n.kt)("p",null,"However, this system might not work very well, considering not every user has rating to every genre and some of the user might not be great at describing their preferences."),(0,n.kt)("h4",{id:"user-based-recommendation"},"User-based recommendation"),(0,n.kt)("p",null,"Another system is to recommend based on similarities between user's preferences. Instead of using user's rating as feature to generate unavailable rating toward specific movie, we use the available movie rating to generate user's feature."),(0,n.kt)("h4",{id:"latent-factors"},"Latent Factors"),(0,n.kt)("p",null,"In user-based recommendation, user features is called ",(0,n.kt)("strong",{parentName:"p"},"latent factors")," or ",(0,n.kt)("strong",{parentName:"p"},"latent features"),", these features are used to determine the pattern or relationship between user and the movie."),(0,n.kt)("p",null,"The numbers will first be random generated, and will also be represented in matrix. The prediction is same as before, user and movie latent factors will be calculated using dot product. The result is the rating prediction for the movie, higher rating means the user will more likely to like that movie."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Dot product between user and movie latent factors",src:r(92522).Z,width:"633",height:"196"}),(0,n.kt)("br",{parentName:"p"}),"\n","Source : ",(0,n.kt)("a",{parentName:"p",href:"https://youtu.be/p4ZZq0736Po?si=OpsMAfAoQ0-6Aak8&t=4307"},"https://youtu.be/p4ZZq0736Po?si=OpsMAfAoQ0-6Aak8&t=4307")),(0,n.kt)("p",null,"But this won't be an accurate prediction, considering the latent factor used are random generated. This is where machine learning comes, these numbers will be adjusted. We will first calculate the loss function e.g. Mean Squared Error (MSE), where we sum all the difference between predicted rating and actual rating squared and divided it by the number of ratings. We can then use optimizer like ",(0,n.kt)("a",{parentName:"p",href:"/machine-learning/linear-regression#gradient-descent"},"gradient descent"),"."),(0,n.kt)("p",null,"We can also add some bias terms or extra constant value to the user and movie ratings and use ",(0,n.kt)("a",{parentName:"p",href:"/deep-learning/deep-learning-foundation#activation-function"},"activation function")," like sigmoid, this is used to capture relationship between them that are not captured by latent factors."),(0,n.kt)("p",null,"We can even visualize this in graph, because latent factors or the features are in form of vector (matrix). Higher dimensional features can be reduced using technique like ",(0,n.kt)("a",{parentName:"p",href:"/machine-learning/principal-component-analysis"},"PCA"),". During the training process, the model will be trained to group similar items together."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Book embedding",src:r(73387).Z,width:"512",height:"357"}),(0,n.kt)("br",{parentName:"p"}),"\n","Source : ",(0,n.kt)("a",{parentName:"p",href:"https://devopedia.org/word-embedding"},"https://devopedia.org/word-embedding")),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"This recommendation system is based on ",(0,n.kt)("strong",{parentName:"p"},"dot product model"),", where the model predict using dot product. Making recommendation system using ",(0,n.kt)("a",{parentName:"p",href:"/deep-learning"},"deep learning")," technique like ",(0,n.kt)("a",{parentName:"p",href:"/deep-learning/neural-network"},"deep neural network")," is also possible.")),(0,n.kt)("h4",{id:"compression"},"Compression"),(0,n.kt)("p",null,"Now, after all the technique used, the latent factors is all we need to predict user rating. We can keep calculating the dot product and fill out the empty rating table. These latent factors are able to capture pattern of user's rating."),(0,n.kt)("p",null,"The latent factors technique is not only used in collaborative filtering, it can also be used as compression method. If we think the movie's rating as a color of image represented in matrix, taking the dot product between the latent factors will give us original image back."))}d.isMDXComponent=!0},95519:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/dot-product-9e5d55fa1c2f780768f390a21cdd01ee.png"},73387:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/embedding-24164ceb8ad34d59490bebc617c4e2f3.png"},57024:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/type-of-collaborative-filtering-efa241c93351447e3d56bc78f78c74c1.png"},92522:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/user-based-filtering-b9678e1532c8b5a045df583a166afc0d.png"},15252:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/user-rating-table-a2ba3df22205fca9811c7d35ed632067.png"}}]);